<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>D3 Projection Selector</title>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://d3js.org/topojson.v3.min.js"></script>
<script src="https://d3js.org/d3-geo-projection.v4.min.js"></script>

<style>
  body {
    margin: 0;
    background: #111;
    color: #eee;
    font-family: sans-serif;
  }
  #controls {
    padding: 1em;
    background: #222;
    display: flex;
    gap: 1em;
    align-items: center;
  }
  #map {
    width: 100vw;
    height: calc(100vh - 60px);
  }
  select {
    background: #333;
    color: #eee;
    border: 1px solid #555;
    padding: 0.3em;
  }
</style>
</head>
<body>

<div id="controls">
  <label for="proj">Projection:</label>
  <select id="proj"></select>
</div>

<svg id="map"></svg>

<script>
// --------------------------------------------
// List of real projections that exist in D3 v7
// and d3-geo-projection v4.
// --------------------------------------------
const projectionList = [
  // Core d3-geo
  "geoMercator", "geoEquirectangular", "geoEqualEarth",
  "geoNaturalEarth1", "geoTransverseMercator",
  "geoOrthographic", "geoAzimuthalEqualArea",
  "geoAzimuthalEquidistant", "geoStereographic",
  "geoGnomonic",

  // d3-geo-projection
  "geoAitoff", "geoArmadillo", "geoAugust", "geoBaker",
  "geoBerghaus", "geoBoggs", "geoBonne", "geoBraun",
  "geoCollignon", "geoCraig", "geoCraster",
  "geoCylindricalEqualArea", "geoCylindricalStereographic",
  "geoEckert1", "geoEckert2", "geoEckert3", "geoEckert4",
  "geoEckert5", "geoEckert6", "geoEisenlohr", "geoFahey",
  "geoFoucaut", "geoFoucautSinusoidal", "geoGilbert",
  "geoGingery", "geoHammer", "geoHill", "geoHomolosine",
  "geoHufnagel", "geoKavrayskiy7", "geoLagrange",
  "geoLarrivee", "geoLaskowski", "geoLoximuthal",
  "geoMiller", "geoModifiedStereographic",
  "geoMollweide", "geoMtFlatPolarParabolic",
  "geoMtFlatPolarQuartic", "geoMtFlatPolarSinusoidal",
  "geoNaturalEarth2", "geoNellHammer", "geoPolyconic",
  "geoRectangularPolyconic", "geoRobinson",
  "geoSinusoidal", "geoSinuMollweide", "geoTimes",
  "geoVanDerGrinten", "geoVanDerGrinten2",
  "geoVanDerGrinten3", "geoVanDerGrinten4",
  "geoWagner", "geoWagner4", "geoWagner6",
  "geoWagner7", "geoWinkel1", "geoWinkel2", "geoWinkel3"
];

// Populate dropdown (VALUE stays "geoX", TEXT removes "geo")
const sel = document.getElementById("proj");
projectionList.forEach(name => {
  const opt = document.createElement("option");
  opt.value = name;
  opt.textContent = name.replace(/^geo/, "");
  sel.appendChild(opt);
});

// SVG setup
const width = window.innerWidth;
const height = window.innerHeight - 60;

const svg = d3.select("#map");

// Background
svg.append("rect")
  .attr("width", width)
  .attr("height", height)
  .attr("fill", "#042342");

const g = svg.append("g");

let projection, path, world;

// Zoom
const zoom = d3.zoom()
  .scaleExtent([0.5, 5000])
  .on("zoom", (event) => g.attr("transform", event.transform));

svg.call(zoom);

// Set projection dynamically
function setProjection(type) {
  const ctor = d3[type];
  if (!ctor) return;

  projection = ctor();

  projection.fitSize(
    [width, height],
    topojson.feature(world, world.objects.countries)
  );

  path = d3.geoPath(projection);

  draw();
}

function draw() {
  g.selectAll("*").remove();

  g.selectAll("path")
    .data(topojson.feature(world, world.objects.countries).features)
    .enter()
    .append("path")
    .attr("d", path)
    .attr("fill", "#12385d")
    .attr("stroke", "#95abc2")
    .attr("stroke-width", 0.1);
}

d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-50m.json")
  .then(data => {
    world = data;
    setProjection("geoVanDerGrinten");
  });

sel.addEventListener("change", e => {
  setProjection(e.target.value);
  svg.call(zoom.transform, d3.zoomIdentity);
});
</script>

</body>
</html>
